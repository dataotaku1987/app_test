import streamlit as st
import pandas as pd
import altair as alt

# ë°ì´í„° ì •ì˜
data = {
    "ì›”": [
        "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06",
        "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12"
    ],
    "ë§¤ì¶œì•¡": [
        12000000, 13500000, 11000000, 18000000, 21000000, 24000000,
        22500000, 23000000, 19500000, 25000000, 26500000, 28000000
    ],
    "ì „ë…„ë™ì›”": [
        10500000, 11200000, 12800000, 15200000, 18500000, 20100000,
        19000000, 20500000, 18000000, 21500000, 23000000, 25000000
    ]
}

# ë°ì´í„°í”„ë ˆì„ ìƒì„± ë° ì¦ê°ë¥  ê³„ì‚°
df = pd.DataFrame(data)
df["ì¦ê°ë¥  (%)"] = ((df["ë§¤ì¶œì•¡"] - df["ì „ë…„ë™ì›”"]) / df["ì „ë…„ë™ì›”"]) * 100

# ì œëª© ì¶œë ¥
st.title("ğŸ“Š ì›”ë³„ ë§¤ì¶œ ëŒ€ì‹œë³´ë“œ")
st.subheader("2024ë…„ ë§¤ì¶œ ë° ì „ë…„ ë™ì›” ëŒ€ë¹„ ë¶„ì„")

# ë¼ì¸ ì°¨íŠ¸ ì‹œê°í™”ìš© ë°ì´í„° ë³€í™˜
df_melted = df.melt(id_vars="ì›”", value_vars=["ë§¤ì¶œì•¡", "ì „ë…„ë™ì›”"],
                    var_name="ë§¤ì¶œ êµ¬ë¶„", value_name="ê¸ˆì•¡")

# ì°¨íŠ¸ ìƒì„±
chart = alt.Chart(df_melted).mark_line(point=True).encode(
    x=alt.X("ì›”:N", title="ì›”"),
    y=alt.Y("ê¸ˆì•¡:Q", title="ê¸ˆì•¡ (ì›)"),
    color="ë§¤ì¶œ êµ¬ë¶„:N",
    tooltip=["ì›”", "ë§¤ì¶œ êµ¬ë¶„", "ê¸ˆì•¡"]
).properties(
    width=700,
    height=400,
    title="ì›”ë³„ ë§¤ì¶œ ë° ì „ë…„ë™ì›” ë¹„êµ"
)

# ì°¨íŠ¸ ì¶œë ¥
st.altair_chart(chart, use_container_width=True)

# ë°ì´í„°í”„ë ˆì„ ì¶œë ¥
st.markdown("### ğŸ“„ ì›ì‹œ ë°ì´í„° í…Œì´ë¸”")
st.dataframe(df.style.format({
    "ë§¤ì¶œì•¡": "{:,}",
    "ì „ë…„ë™ì›”": "{:,}",
    "ì¦ê°ë¥  (%)": "{:.1f}"
}), use_container_width=True)
